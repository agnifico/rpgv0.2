import"../chunks/DsnmJJEf.js";import"../chunks/CLf4CbaX.js";import{o as Ot}from"../chunks/bJgjr3oX.js";import{ap as Zt,m as S,s as E,aB as qt,aC as zt,aq as p,aD as Bt,ar as j,as as _,at as Gt,g as t,aE as Ut,av as o,au as l,u as n,ax as s,W as k,a8 as z,aA as lt}from"../chunks/C9d5v2_X.js";import{e as u,s as V}from"../chunks/CxpGAOF5.js";import{i as A}from"../chunks/DN0X4rAG.js";import{e as B,i as G}from"../chunks/BLjquezv.js";import{s as v}from"../chunks/OwQstUqB.js";import{s as U,a as Kt,b as Yt}from"../chunks/BgMmMX2O.js";import{s as K}from"../chunks/CS0QiQyS.js";import{b as Jt}from"../chunks/EgJc2U9m.js";import{i as Nt}from"../chunks/BQ3WBjMy.js";import{s as Qt,a as te}from"../chunks/DFZtd7Ml.js";import{g as c,V as it,b as ct}from"../chunks/BMfR17sD.js";var ee=p('<button class="time-of-day svelte-1jx9r8t"><img alt="Day Logo" srcset=""/></button>'),ae=p('<button class="time-of-day svelte-1jx9r8t" title="(time_msg)"><img alt="Day Logo" srcset=""/></button>'),re=p('<div class="player-icon svelte-1jx9r8t"><img alt="Player" class="player-image svelte-1jx9r8t"/></div>'),se=p("<img/>"),oe=p('<img class="tile-image svelte-1jx9r8t"/> <!> <!>',1),ne=p("<div><!></div>"),le=p('<div class="map-row svelte-1jx9r8t"></div>'),ie=p('<pre class="tooltip-content svelte-1jx9r8t"> </pre>'),ce=p('<img class="encounter-image svelte-1jx9r8t"/> <h3 class="svelte-1jx9r8t"> </h3> <p> </p> <div class="stats-and-hide-buttons svelte-1jx9r8t"><div class="stats-tooltip-container svelte-1jx9r8t"><button class="stats-button svelte-1jx9r8t" disabled>Stats</button> <!></div> <button class="hide-button svelte-1jx9r8t">Hide</button></div>',1),ve=p("<p> </p>"),ue=p('<div class="buttons-tray svelte-1jx9r8t"><div class="dpad-container svelte-1jx9r8t"><a class="dpad-button inventory-button svelte-1jx9r8t"><img alt="Inventory" class="dpad-icon svelte-1jx9r8t"/></a> <button class="dpad-button up svelte-1jx9r8t">&#9650;</button> <button class="dpad-button hide-controls-button svelte-1jx9r8t">&#10005;</button> <button class="dpad-button left svelte-1jx9r8t">&#9664;</button> <button class="dpad-button down svelte-1jx9r8t">&#9660;</button> <button class="dpad-button right svelte-1jx9r8t">&#9654;</button></div> <div class="action-buttons svelte-1jx9r8t"><button class="action-button svelte-1jx9r8t">E</button> <button class="action-button svelte-1jx9r8t">F</button> <button class="action-button svelte-1jx9r8t">Z</button> <button class="action-button svelte-1jx9r8t">X</button> <button class="action-button svelte-1jx9r8t">C</button> <button class="action-button svelte-1jx9r8t">V</button></div></div>'),de=p('<button class="floating-restore-button svelte-1jx9r8t">Show Controls</button>'),me=p("<p> </p> <p> </p>",1),_e=p("<p> </p>"),pe=p('<div class="fullscreen-image-details svelte-1jx9r8t"><h3> </h3> <!> <!></div>'),be=p('<div class="fullscreen-overlay svelte-1jx9r8t"><div class="fullscreen-image-container svelte-1jx9r8t"><button class="close-button svelte-1jx9r8t">&times;</button> <img alt="Fullscreen" class="fullscreen-image svelte-1jx9r8t"/> <!></div></div>'),ge=p('<main tabindex="0" class="svelte-1jx9r8t"><div class="game-container svelte-1jx9r8t"><div class="top-bar svelte-1jx9r8t"><div class="top-icons svelte-1jx9r8t"><a><button class="curved-brown-left"><img alt="" srcset=""/></button></a> <a><button class="icon64 svelte-1jx9r8t"><img alt="" srcset=""/></button></a></div> <!> <div class="hp-bar-container svelte-1jx9r8t"><div class="hp-bar svelte-1jx9r8t"></div></div></div> <div class="map-screen svelte-1jx9r8t"></div> <div><!></div> <div class="text-box-container svelte-1jx9r8t"><div class="text-box svelte-1jx9r8t"></div> <div class="small-encounter-screen svelte-1jx9r8t"><img alt="" class="svelte-1jx9r8t"/></div></div> <!></div> <!></main>');function Fe(gt,vt){Zt(vt,!1);const[ft,xt]=te(),ht=()=>Qt(c,"$gameStore",ft),yt=".";let e=S(ht()),X=S(),Y=S(!0),jt="The time of day: Dawn / Dusk - changes every 50 steps you take.";c.subscribe(a=>{E(e,a)});function kt(a,r){return t(e).map.find(i=>i.x===a&&i.y===r)}function It(a,r){return t(e).entities.filter(i=>i.x===a&&i.y===r)}function wt(a){if(t(e).showFullscreenImage&&a.key==="Escape"){c.closeFullscreenImage();return}switch(a.key){case"ArrowUp":case"w":c.movePlayer(0,-1);break;case"ArrowDown":case"s":c.movePlayer(0,1);break;case"ArrowLeft":case"a":c.movePlayer(-1,0);break;case"ArrowRight":case"d":c.movePlayer(1,0);break;case"z":c.handleAction("Z");break;case"x":c.handleAction("X");break;case"c":c.handleAction("C");break;case"v":c.handleAction("V");break}}let J=S(!1),N=S("");function Et(a){E(J,!0),E(N,`HP: ${a.hp}

			Attack: ${a.attack}`)}function At(){E(J,!1),E(N,"")}Ot(()=>{t(X)&&t(X).focus()});let Q=S(!0);function Dt(a){return a.startsWith("[World]:")?"world":t(e).entities.some(r=>a.startsWith(`[${r.name}]:`)&&r.type==="npc")?"npc":a.includes("defeated")?"enemy":"player"}qt(()=>t(e),()=>{t(e).currentEncounter&&E(Y,!0)}),zt(),Nt();var M=ge();Bt(a=>{Ut.title="Map - RPG"});var tt=o(M),et=o(tt),at=o(et),L=o(at);v(L,"href","./");var ut=o(L),$t=o(ut);v($t,"src","./game_icons/home_page.png"),s(ut),s(L);var rt=l(L,2);v(rt,"href","./");var dt=o(rt),Pt=o(dt);v(Pt,"src","./game_icons/settings.png"),s(dt),s(rt),s(at);var mt=l(at,2);{var Tt=a=>{var r=ee();v(r,"title",jt),K(r,"",{},{"background-color":"#6abbcd","border-color":"#bce5f6"});var i=o(r);v(i,"src","./game_icons/day.png"),s(r),_(a,r)},Ft=a=>{var r=ae();K(r,"",{},{"background-color":"#2f488b","border-color":"#c68df5"});var i=o(r);v(i,"src","./game_icons/night.png"),s(r),_(a,r)};A(mt,a=>{t(e),n(()=>t(e).timeOfDay=="day")?a(Tt):a(Ft,!1)})}var _t=l(mt,2),Ht=o(_t);s(_t),s(et);var O=l(et,2);B(O,5,()=>(k(it),n(()=>Array(it))),G,(a,r,i)=>{var d=le();B(d,5,()=>(k(ct),n(()=>Array(ct))),G,(I,D,H,b)=>{const m=z(()=>(t(e),n(()=>t(e).player.viewX+H))),g=z(()=>(t(e),n(()=>t(e).player.viewY+i))),f=z(()=>(k(t(m)),k(t(g)),n(()=>kt(t(m),t(g))))),$=z(()=>(k(t(m)),k(t(g)),n(()=>It(t(m),t(g)))));var y=ne(),w=o(y);{var P=x=>{var T=oe(),F=lt(T),C=l(F,2);{var q=R=>{var h=re(),W=o(h);v(W,"src","./game_icons/player_icon.png"),s(h),_(R,h)};A(C,R=>{t(e),k(t(m)),k(t(g)),n(()=>t(e).player.x===t(m)&&t(e).player.y===t(g))&&R(q)})}var nt=l(C,2);B(nt,1,()=>t($),G,(R,h)=>{var W=se();j(()=>{v(W,"src",(t(h),n(()=>t(h)?.thumbnailImage?t(h).thumbnailImage:yt+"/game_icons/entity_icon.png"))),v(W,"alt",(t(h),n(()=>t(h).name))),U(W,1,`entity-icon ${t(h),n(()=>t(h).type)??""}`,"svelte-1jx9r8t"),v(W,"title",(t(h),n(()=>t(h).name)))}),_(R,W)}),j(()=>{v(F,"src",(k(t(f)),n(()=>t(f).tileImage))),v(F,"alt",(k(t(f)),n(()=>t(f).tileType)))}),_(x,T)};A(w,x=>{t(f)&&x(P)})}s(y),j(()=>U(y,1,`map-tile ${k(t(f)),n(()=>t(f)?.tileType)??""}`,"svelte-1jx9r8t")),_(I,y)}),s(d),_(a,d)}),s(O);var Z=l(O,2);let pt;var Vt=o(Z);{var Wt=a=>{var r=ce(),i=lt(r),d=l(i,2),I=o(d,!0);s(d);var D=l(d,2),H=o(D,!0);s(D);var b=l(D,2),m=o(b),g=o(m),f=l(g,2);{var $=w=>{var P=ie(),x=o(P,!0);s(P),j(()=>V(x,t(N))),_(w,P)};A(f,w=>{t(J)&&w($)})}s(m);var y=l(m,2);s(b),j(()=>{v(i,"src",(t(e),n(()=>t(e).currentEncounter.profileImage))),v(i,"alt",(t(e),n(()=>t(e).currentEncounter.name))),V(I,(t(e),n(()=>t(e).currentEncounter.name))),V(H,(t(e),n(()=>t(e).currentEncounter.description)))}),u("click",i,()=>c.openFullscreenImage(t(e).currentEncounter.mainImage,{name:t(e).currentEncounter.name,type:t(e).currentEncounter.type,hp:t(e).currentEncounter.hp,attack:t(e).currentEncounter.attack,dialogues:t(e).currentEncounter.dialogues.heart[t(e).currentEncounter.heartRank],profileImage:t(e).currentEncounter.profileImage,mainImage:t(e).currentEncounter.mainImage})),u("mouseenter",g,()=>Et(t(e).currentEncounter)),u("mouseleave",g,At),u("click",y,()=>E(Y,!1)),_(a,r)};A(Vt,a=>{t(e),n(()=>t(e).currentEncounter)&&a(Wt)})}s(Z);var st=l(Z,2),ot=o(st);B(ot,5,()=>(t(e),n(()=>t(e).currentMessage)),G,(a,r)=>{var i=ve(),d=o(i,!0);s(i),j(I=>{U(i,1,`message ${I??""}`,"svelte-1jx9r8t"),V(d,t(r))},[()=>(t(r),n(()=>Dt(t(r))))]),_(a,i)}),s(ot);var bt=l(ot,2),Ct=o(bt);v(Ct,"src","./general/shrooms.png"),s(bt),s(st);var St=l(st,2);{var Mt=a=>{var r=ue(),i=o(r),d=o(i);v(d,"href","./inventory");var I=o(d);v(I,"src","./game_icons/backpack.png"),s(d);var D=l(d,2),H=l(D,2),b=l(H,2),m=l(b,2),g=l(m,2);s(i);var f=l(i,2),$=l(o(f),4),y=l($,2),w=l(y,2),P=l(w,2);s(f),s(r),u("click",D,()=>c.movePlayer(0,-1)),u("click",H,()=>E(Q,!1)),u("click",b,()=>c.movePlayer(-1,0)),u("click",m,()=>c.movePlayer(0,1)),u("click",g,()=>c.movePlayer(1,0)),u("click",$,()=>c.handleAction("Z")),u("click",y,()=>c.handleAction("X")),u("click",w,()=>c.handleAction("C")),u("click",P,()=>c.handleAction("V")),_(a,r)},Rt=a=>{var r=de();u("click",r,()=>E(Q,!0)),_(a,r)};A(St,a=>{t(Q)?a(Mt):a(Rt,!1)})}s(tt);var Xt=l(tt,2);{var Lt=a=>{var r=be(),i=o(r),d=o(i),I=l(d,2),D=l(I,2);{var H=b=>{var m=pe(),g=o(m),f=o(g,!0);s(g);var $=l(g,2);{var y=x=>{var T=me(),F=lt(T),C=o(F);s(F);var q=l(F,2),nt=o(q);s(q),j(()=>{V(C,`HP: ${t(e),n(()=>t(e).fullscreenImageDetails.hp)??""}`),V(nt,`Attack: ${t(e),n(()=>t(e).fullscreenImageDetails.attack)??""}`)}),_(x,T)};A($,x=>{t(e),n(()=>t(e).fullscreenImageDetails.type==="enemy")&&x(y)})}var w=l($,2);{var P=x=>{var T=_e(),F=o(T);s(T),j(C=>V(F,`Dialogue: ${C??""}`),[()=>(t(e),n(()=>t(e).fullscreenImageDetails.dialogues[~~(Math.random()*t(e).fullscreenImageDetails.dialogues.length)]))]),_(x,T)};A(w,x=>{t(e),n(()=>t(e).fullscreenImageDetails.type==="npc")&&x(P)})}s(m),j(()=>V(f,(t(e),n(()=>t(e).fullscreenImageDetails.name)))),_(b,m)};A(D,b=>{t(e),n(()=>t(e).fullscreenImageDetails)&&b(H)})}s(i),s(r),j(()=>v(I,"src",(t(e),n(()=>t(e).fullscreenImageUrl)))),u("click",d,function(...b){c.closeFullscreenImage?.apply(this,b)}),u("click",i,Kt(function(b){Yt.call(this,vt,b)})),u("click",r,function(...b){c.closeFullscreenImage?.apply(this,b)}),_(a,r)};A(Xt,a=>{t(e),n(()=>t(e).showFullscreenImage)&&a(Lt)})}s(M),Jt(M,a=>E(X,a),()=>t(X)),j(a=>{K(Ht,`width: ${t(e),n(()=>t(e).player.hp/t(e).player.maxHp*100)??""}%`),K(O,`--viewport-width: ${ct}; --viewport-height: ${it}; --tile-size: 32px;`),pt=U(Z,1,"encounter-box svelte-1jx9r8t",null,pt,a)},[()=>({hidden:!t(e).currentEncounter||!t(Y)})]),u("keydown",M,wt),_(gt,M),Gt(),xt()}export{Fe as component};
