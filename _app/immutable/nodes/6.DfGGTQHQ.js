import"../chunks/DsnmJJEf.js";import"../chunks/DKbr7FTX.js";import{o as ye}from"../chunks/CyCOytMA.js";import{l as we,e as ke,m as xe,aF as Se,i as Te,t as Ee,ak as Ne,a5 as _,al as k,aA as Ce,ar as Ae,as as b,au as p,am as w,an as De,aB as Me,ao as v,aq as o,P as e,aw as r,ap as s,aG as qe,aC as W,at as U,aH as ve}from"../chunks/MrBcGwl5.js";import{i as de}from"../chunks/CgIxXxhB.js";import{e as B,i as F}from"../chunks/BrZ-0oqd.js";import{b as Ge,s as He,r as Ie}from"../chunks/DEeg4q6a.js";import{s as Z}from"../chunks/CtQ7uExx.js";import{a as Pe}from"../chunks/DnM7N6mS.js";import{p as $e,s as Oe,b as We}from"../chunks/DEdAOqeD.js";import{i as Be}from"../chunks/jgPfo2ed.js";function ce(l,d,h=!1){if(l.multiple){if(d==null)return;if(!xe(d))return Se();for(var u of l.options)u.selected=d.includes(J(u));return}for(u of l.options){var t=J(u);if(Te(t,d)){u.selected=!0;return}}(!h||d!==void 0)&&(l.selectedIndex=-1)}function Fe(l){var d=new MutationObserver(()=>{ce(l,l.__value)});d.observe(l,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Ee(()=>{d.disconnect()})}function ue(l,d,h=d){var u=!0;we(l,"change",t=>{var y=t?"[selected]":":checked",x;if(l.multiple)x=[].map.call(l.querySelectorAll(y),J);else{var A=l.querySelector(y)??l.querySelector("option:not([disabled])");x=A&&J(A)}h(x)}),ke(()=>{var t=d();if(ce(l,t,u),u&&t===void 0){var y=l.querySelector(":checked");y!==null&&(t=J(y),h(t))}l.__value=t,u=!1}),Fe(l)}function J(l){return"__value"in l?l.__value:l.value}var Je=k('<div class="event-marker svelte-oefn5i"> </div>'),Re=k('<div class="grid-cell svelte-oefn5i"><!></div>'),Le=k('<div class="grid-row svelte-oefn5i"></div>'),Ue=k("<div></div>"),Ke=k("<option> </option>"),je=k("<option> </option>"),ze=k('<div class="modal-backdrop svelte-oefn5i"><div class="modal svelte-oefn5i"><h3> </h3> <div class="form-group svelte-oefn5i"><label for="npc-select">NPC</label> <select id="npc-select"><option>None</option><!></select></div> <div class="form-group svelte-oefn5i"><label for="location-event">Location Event</label> <input type="text" id="location-event"/></div> <div class="form-group svelte-oefn5i"><label for="enemy-select">Enemy</label> <select id="enemy-select"><option>None</option><!></select></div> <div class="modal-buttons svelte-oefn5i"><button>Save</button> <button>Cancel</button></div></div></div>'),Qe=k('<div class="map-creator-container svelte-oefn5i"><div class="grid-container svelte-oefn5i"></div> <div class="controls-container svelte-oefn5i"><h2>Tiles</h2> <div class="tile-palette svelte-oefn5i"></div> <button>Fill All</button> <button>Clear Selected Tile</button> <hr/> <h2>JSON Output</h2> <textarea readonly="" class="svelte-oefn5i"></textarea></div></div> <!>',1);function sa(l,d){Ne(d,!1);const h=20,u=20;let t=_(Array(u).fill(null).map(()=>Array(h).fill(null))),y=_([]),x=_([]),A=_([]),S=_(null),D=_(""),M=_(""),G=_(""),K=_(!1),R=_({x:0,y:0}),j=_(!1);ye(async()=>{r(y,["/images/tiles/grass1.png","/images/tiles/grass2.png","/images/tiles/grass3.png","/images/tiles/grass4.png","/images/tiles/grass5.png","/images/tiles/grass6.png","/images/tiles/grass7.png","/images/tiles/grass8.png","/images/tiles/grass9.png","/images/tiles/water0.png","/images/tiles/water4.png","/images/tiles/waterBoat1.png","/images/tiles/waterBoat2.png","/images/tiles/waterPlant.png","/images/tiles/waterRock.png"]),r(x,[{id:"cassie",name:"Cassie"},{id:"kitana",name:"Kitana"},{id:"neela",name:"Neela, Water Nymph"},{id:"cygwin",name:"Cygwin, The Dubitable Nun"},{id:"wachiwi",name:"Wachiwi, The Dancing Girl"}]),r(A,[{id:"hela",name:"Hela, Goddess of Underworld"},{id:"ariel",name:"Ariel, Summoner of the Seas"},{id:"hilda",name:"Hilda, Manifest of Strength"},{id:"nuala",name:"Nuala, Shadow in the Water"}])});function ee(i,a){e(S)&&(W(t,e(t)[a][i]={tile:e(S)}),r(t,[...e(t)]))}function ae(){r(S,null)}function fe(i,a){if(ae(),!e(t)[a][i]){alert("Please select a tile first.");return}r(R,{x:i,y:a}),r(K,!0)}function me(){const{x:i,y:a}=e(R);e(D)?W(t,e(t)[a][i].event={type:"npc",id:e(D)}):e(G)?W(t,e(t)[a][i].event={type:"location",description:e(G)}):e(M)&&W(t,e(t)[a][i].event={type:"enemy",id:e(M)}),r(t,[...e(t)]),z()}function z(){r(K,!1),r(D,""),r(M,""),r(G,"")}function _e(){const i={tiles:[],events:[]};for(let a=0;a<u;a++)for(let n=0;n<h;n++)e(t)[a][n]&&(i.tiles.push({x:n,y:a,image:e(t)[a][n].tile}),e(t)[a][n].event&&i.events.push({x:n,y:a,...e(t)[a][n].event}));return JSON.stringify(i,null,2)}Be();var te=Qe();Ce(i=>{Me.title="Map Creator"});var Q=Ae(te),L=v(Q);Z(L,"--grid-height: 20;"),B(L,5,()=>e(t),F,(i,a,n)=>{var g=Le();B(g,5,()=>e(a),F,(H,T,E)=>{var c=Re(),X=v(c);{var I=q=>{var N=Je(),P=v(N,!0);s(N),b($=>U(P,$),[()=>e(T).event.type.charAt(0).toUpperCase()]),w(q,N)};de(X,q=>{e(T)?.event&&q(I)})}s(c),b(()=>Z(c,`background-image: url(${(e(T)?.tile||"")??""})`)),p("mousedown",c,()=>{r(j,!0),ee(E,n)}),p("mouseup",c,()=>r(j,!1)),p("mouseover",c,()=>{e(j)&&ee(E,n)}),p("contextmenu",c,$e(()=>fe(E,n))),w(H,c)}),s(g),w(i,g)}),s(L);var ie=o(L,2),V=o(v(ie),2);B(V,5,()=>e(y),F,(i,a)=>{var n=Ue();let g;b(H=>{g=He(n,1,"tile-preview svelte-oefn5i",null,g,H),Z(n,`background-image: url(${e(a)??""})`)},[()=>({selected:e(S)===e(a)})]),p("click",n,()=>r(S,e(S)===e(a)?null:e(a))),w(i,n)}),s(V);var le=o(V,2),ne=o(le,2),re=o(ne,6);qe(re),s(ie),s(Q);var pe=o(Q,2);{var ge=i=>{var a=ze(),n=v(a),g=v(n),H=v(g);s(g);var T=o(g,2),E=o(v(T),2);b(()=>{e(D),ve(()=>{e(x)})});var c=v(E);c.value=c.__value="";var X=o(c);B(X,1,()=>e(x),F,(f,C)=>{var m=Ke(),Y=v(m,!0);s(m);var O={};b(()=>{U(Y,e(C).name),O!==(O=e(C).id)&&(m.value=(m.__value=e(C).id)??"")}),w(f,m)}),s(E),s(T);var I=o(T,2),q=o(v(I),2);Ie(q),s(I);var N=o(I,2),P=o(v(N),2);b(()=>{e(M),ve(()=>{e(A)})});var $=v(P);$.value=$.__value="";var be=o($);B(be,1,()=>e(A),F,(f,C)=>{var m=je(),Y=v(m,!0);s(m);var O={};b(()=>{U(Y,e(C).name),O!==(O=e(C).id)&&(m.value=(m.__value=e(C).id)??"")}),w(f,m)}),s(P),s(N);var se=o(N,2),oe=v(se),he=o(oe,2);s(se),s(n),s(a),b(()=>U(H,`Add Event to Tile (${e(R).x??""}, ${e(R).y??""})`)),ue(E,()=>e(D),f=>r(D,f)),Pe(q,()=>e(G),f=>r(G,f)),ue(P,()=>e(M),f=>r(M,f)),p("click",oe,me),p("click",he,z),p("click",n,Oe(function(f){We.call(this,d,f)})),p("click",a,z),w(i,a)};de(pe,i=>{e(K)&&i(ge)})}b(i=>Ge(re,i),[_e]),p("click",le,()=>{for(let i=0;i<u;i++)for(let a=0;a<h;a++)W(t,e(t)[i][a]={tile:e(S)});r(t,[...e(t)])}),p("click",ne,ae),w(l,te),De()}export{sa as component};
